<?php
function referurl($type,$name,$location=2,$media_path=''){
	$CI=& get_instance();
	$url='';
	$path=explode('/',$media_path,2);
	switch($type){
		case 'css':
			if($location==1){
				$url='<link rel="stylesheet" href="'.get_cdn_url('public/'.$media_path.'/styles/'.$name).'" type="text/css"/>';
			}
			else if($location==2){
				$url='<link rel="stylesheet" href="'.get_cdn_url('public/'.$path[0].'/public/styles/'.$name).'" type="text/css"/>';
			}
			else if($location==3){
				$url='<link rel="stylesheet" href="'.get_cdn_url('public/media/styles/'.$name).'" type="text/css"/>';
			}
			break;
		case 'js':	
			if($location==1){
				$url='<script type="text/javascript" src="'.get_cdn_url('public/'.$media_path.'/scripts/'.$name).'"></script>';
			}
			else if($location==2){
				$url='<script type="text/javascript" src="'.get_cdn_url('public/'.$path[0].'/public/scripts/'.$name).'"></script>';
			}
			else if($location==3){
				$url='<script type="text/javascript" src="'.get_cdn_url('public/media/scripts/'.$name).'"></script>';
			}
			break;
		case 'img':	
			if($location==1){
				$url=get_cdn_url('public/'.$media_path.'/images/'.$name);
			}
			else if($location==2){
				$url=get_cdn_url('public/'.$path[0].'/public/images/'.$name);
			}
			else if($location==3){
				$url=get_cdn_url('public/media/images/'.$name);
			}
			break;
		case 'sound':	
			if($location==1){
				$url=get_cdn_url('public/'.$media_path.'/sounds/'.$name);
			}
			else if($location==2){
				$url=get_cdn_url('public/'.$path[0].'/public/sounds/'.$name);
			}
			else if($location==3){
				$url=get_cdn_url('public/media/sounds/'.$name);
			}
			break;
		default:
			break;
	}	
	return $url;
}

/**
 * 取cdn
 * @param unknown $url
 * @return string
 */
function get_cdn_url($url){
	
	include 'public/version.php';

	$ver = isset($js_css_version)?$js_css_version:"0";
	
	$config = & get_config();
	
	$inter_id = isset($_GET['id'])?$_GET['id']:"";
	
	// && $inter_id == "a426755343"
	
	if(isset($config['cdn_host']) && $config['cdn_host'] != ""){
		
		return $config['cdn_host']."/".$url."?v={$ver}";
		
				
	}else{
		$CI=& get_instance();
		return $CI->config->base_url( $url );
	}
	
}

