webpackJsonp([7],{222:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=t(101),a=t.n(s),n=t(99),i=t(83),l=t(118),r=function(e,o){var t=o.$refs.goodsInfoTable.store.states.selection;e.forEach(function(e){o.goodInfoItems.items[e.goods_id]&&-1===t.indexOf(e)&&t.push(e)})};o.default={data:function(){return{page:1,size:2,goodItemsMaxSelectionCount:2,pageHasHardCodeSelection:{}}},methods:a()({},t.i(n.b)("goods",[i.a]),t.i(n.d)("goods",[i.e]),t.i(n.d)([i.p]),t.i(n.d)("form",[i.n]),{handleSelectionGoodsChange:function(e){var o={};e.forEach(function(e){o[e.goods_id]={gs_id:e.goods_id,num:e.good_max_num}}),this[i.n]({goods_info:{items:o}})},handleGoodInfosCurrentChange:function(e){var o=this.size*(e-1);this.goodIds[o]||this[i.a]({page:this.page,size:this.size}),this.page=e},goodsInfoSelectable:function(e,o){return!(this.goodInfoItemsNumber>=this.goodItemsMaxSelectionCount)||!!this.goodInfoItems.items[e.goods_id]},handleNextStep:function(){this.goodInfoItemsNumber?this[i.p]({increment:!0}):this.$alert("开启套餐属性必须关联商品",{title:"错误提示",type:"error"})},handlePrevStep:function(){this[i.p]({increment:!1})},handleSyncGood:function(){this[i.e](),this.page=1,this.pageHasHardCodeSelection={},this[i.a]({page:this.page,size:this.size})},disabledChangeGoodMaxNum:function(e){return!this.goodInfoItems.items[e]},showStockTip:function(e){return!!(this.goodInfoItems.items[e.goods_id]&&e.stock<e.good_max_num)}}),computed:a()({},t.i(n.a)("form",["goodInfoSaleWay","isPackages","goodInfoItems"]),t.i(n.a)("goods",["goodIds","goodItems","count","links","loading"]),t.i(n.e)("form",["goodInfoItemsNumber"]),{goods:function(){var e=[];if(this.goodIds.length)for(var o=(this.page-1)*this.size,t=this.page*this.size;o<t;){var s=this.goodIds[o];if(s){var a=this.goodInfoItems.items[s],n=this.goodItems[s];void 0===n.good_max_num&&(n.good_max_num=a&&a.num||1),e.push(n)}o++}return e}}),watch:{goods:function(e){e.length&&!this.pageHasHardCodeSelection[this.page]&&(r(e,this),this.pageHasHardCodeSelection[this.page]=!0)}},beforeRouteEnter:function(e,o,t){t(function(e){if("1"!==e.isPackages)return t({path:l.a[0].path});e.goodIds[0]?e.goods&&e.goods.length&&(r(e.goods,e),e.pageHasHardCodeSelection[e.page]=!0):e[i.a]({page:e.page,size:e.size})})}}},228:function(e,o,t){o=e.exports=t(76)(!1),o.push([e.i,".jfk-info--warning[data-v-3674527f]{line-height:32px}",""])},234:function(e,o,t){var s=t(228);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);t(77)("2ef1961c",s,!0)},240:function(e,o,t){t(234);var s=t(112)(t(222),t(246),"data-v-3674527f",null);e.exports=s.exports},246:function(e,o){e.exports={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"jfk-pages__modules jfk-pages__modules-goods"},[t("div",{staticClass:"jfk-mb-20 jfk-ta-r"},[t("el-button",{staticClass:"jfk-button-tag-a",attrs:{type:"info",size:"small"}},[t("a",{staticClass:"goods_add",attrs:{href:e.links.add,target:"_blank"}},[e._v("新增商品")])]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSyncGood}},[e._v("同步商品")])],1),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-table",{ref:"goodsInfoTable",staticStyle:{width:"100%"},attrs:{data:e.goods,border:"","tooltip-effect":"dark","row-key":"goods_id"},on:{"selection-change":e.handleSelectionGoodsChange}},[t("el-table-column",{attrs:{type:"selection",label:"选择",prop:"goods_id",selectable:e.goodsInfoSelectable,"reserve-selection":"",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"商品名称"}}),e._v(" "),t("el-table-column",{attrs:{prop:"price",label:"原价"}}),e._v(" "),t("el-table-column",{attrs:{prop:"price_package",label:"现价"}}),e._v(" "),t("el-table-column",{attrs:{label:"销售方式"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v("\n          "+e._s(1===e.goodInfoSaleWay?"包价":"自由组合")+"\n        ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"库存"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v("\n          "+e._s(o.row.stock)+"\n          "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showStockTip(o.row),expression:"showStockTip(scope.row)"}],attrs:{size:"mini",type:"danger"}},[e._v("加库存")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-select",{attrs:{size:"small",disabled:e.disabledChangeGoodMaxNum(o.row.goods_id)},model:{value:o.row.good_max_num,callback:function(e){o.row.good_max_num=e},expression:"scope.row.good_max_num"}},e._l(10,function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}))]}}])})],1),e._v(" "),t("el-row",{staticClass:"jfk-margin-vertical-20"},[t("el-col",{staticClass:"jfk-fz-12 jfk-info--dark-white",attrs:{span:12}},[e._v("共"+e._s(e.count)+"个商品，已选择"+e._s(e.goodInfoItemsNumber)+"个商品\n      "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.goodInfoItemsNumber>=e.goodItemsMaxSelectionCount,expression:"goodInfoItemsNumber >= goodItemsMaxSelectionCount"}],staticClass:"jfk-info--warning"},[e._v("\n        ，最多选择"+e._s(e.goodItemsMaxSelectionCount)+"个商品，请删除后再添加其余商品\n      ")])]),e._v(" "),t("el-col",{staticClass:"jfk-ta-r",attrs:{span:12}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.count>e.size,expression:"count > size"}],staticClass:"jfk-d-ib",attrs:{"current-page":e.page,"page-size":e.size,total:e.count,layout:"prev, pager, next, jumper"},on:{"current-change":e.handleGoodInfosCurrentChange,"update:currentPage":function(o){e.page=o}}})],1)],1)],1),e._v(" "),t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{staticClass:"jfk-button--middle",attrs:{size:"large"},nativeOn:{click:function(o){o.preventDefault(),e.handlePrevStep(o)}}},[e._v("上一步")]),e._v(" "),t("el-button",{staticClass:"jfk-button--middle",attrs:{size:"large",type:"primary"},nativeOn:{click:function(o){o.preventDefault(),e.handleNextStep(o)}}},[e._v("下一步")])],1)],1)},staticRenderFns:[]}}});