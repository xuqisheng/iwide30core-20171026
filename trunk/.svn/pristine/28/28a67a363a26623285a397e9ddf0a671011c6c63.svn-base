<?php
/**
 * @desc : 彩虹跑活动
 * @author : Shacaisheng
 * @date  : 2017-07-10
 * @version : V1.0
 *
 */
if (! defined ( 'BASEPATH' ))
    exit ( 'No direct script access allowed' );
class RainbowRun extends MY_Front {
    public  $themeConfig;
    public  $theme = 'rainbowRun';//皮肤
    public $openid;
    public $module;
    public $put_args;
    public $limit_num = 50;
    public $common_data = array();

    function __construct()
    {
        parent::__construct ();
        $this->inter_id = $this->session->userdata ( 'inter_id' );
        $this->openid = $this->session->userdata ( $this->inter_id . 'openid' );

        $this->common_data['csrf_token'] = $this->security->get_csrf_token_name ();
        $this->common_data['csrf_value'] = $this->security->get_csrf_hash ();

        $this->load->helper('appointment');
    }

    /**
     * 活动首页
     */
    public function index()
    {
        $data = array();

        $this->display('activity/index',$data,$this->theme);
    }


    /**
     * 微信配置
     */
    public function wx_config()
    {
        $param = request();
        $inter_id = !empty($param['id']) ? addslashes($param['id']) : '';
        $url = !empty($param['url']) ? addslashes($param['url']) : '';
        $this->load->model('wx/Access_token_model');

        $config_wx = $this->Access_token_model->getSignPackage($inter_id,$url);
        $res_ajax = array(
            'wx_config' => $config_wx,
            'host' => site_url(),
        );

        $res_ajax = array_merge($res_ajax,$this->common_data);
        ajax_return(200,'成功',$res_ajax);
    }





}