webpackJsonp([21],{199:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t(67),c=function(s){return s&&s.__esModule?s:{default:s}}(i),a=t(87),n=function(s){return s.map(function(s,e){return e+"_"+s})},p=function(s){var e={},t=!1;for(var i in s)!function(i){var c=n(s[i].spec_name_id);c.forEach(function(a){e[a]||(e[a]={disabled:!1,ids:[],paths:[]}),0!==Number(s[i].stock)?(c.forEach(function(s){-1===e[a].ids.indexOf(s)&&e[a].ids.push(s)}),e[a].paths.push(c.join("/"))):t=!0})}(i);for(var i in e)e[i].ids.length<2&&(e[i].disabled=!0);return{specMaps:e,hasDisabledSpecItems:t}},o=function(s){var e={},t=[];return s.forEach(function(s,i){e[i]=[],t.push(-1),s.forEach(function(s){e[i].push(i+"_"+s)})}),{rows:e,keys:t}},r=/^(\d+)_/;e.default={name:"good-spec",data:function(){return{spec:{},specKeys:[],settingId:"-1",pricePackage:this.price,hasDisabledSpecItems:!1,specMaps:{},specRows:{},enableSpecItems:[]}},created:function(){var s=this;(0,a.getPackageSpec)({pid:this.productId}).then(function(e){if(s.spec=(0,c.default)({},s.spec,e.web_data),s.spec.spec_type){var t=o(s.spec.spec_name_id);s.specKeys=t.keys,s.specRows=t.rows;var i=p(s.spec.data);s.hasDisabledSpecItems=i.hasDisabledSpecItems,s.specMaps=(0,c.default)({},s.specMaps,i.specMaps)}}).catch(function(s){})},computed:{specVisible:{get:function(){return this.visible},set:function(s){this.$emit("update:visible",s)}}},watch:{specKeys:function(s){if(-1===s.indexOf(-1)){var e=this.getSettingId();this.settingId=e,this.pricePackage=this.spec.data[e].spec_price}else this.settingId="-1"}},methods:{getFullSpecItems:function(s){var e=this;if(s.length>1){var t=[];s.forEach(function(s){t=t.concat(e.specMaps[s].paths)});var i={},c=[];return t.forEach(function(s){if(i[s]){var e=s.split("/");c=c.concat(e)}else i[s]=1}),c}return this.specMaps[s[0]].ids},changeSpecItemsStatus:function(s,e){var t=this;s.forEach(function(s){-1!==e.indexOf(s)?t.specMaps[s].disabled=!1:t.specMaps[s].disabled=!0})},resetSpecItemsStatus:function(){for(var s in this.specMaps)this.specMaps[s].ids.length<2?this.specMaps[s].disabled=!0:this.specMaps[s].disabled=!1},detectionSpecStatus:function(){if(!this.hasDisabledSpecItems)return!0;var s=[],e=[],t=[],i=this;if(this.specKeys.forEach(function(c,a){var n=a+"_"+c,p=i.specRows[a];-1!==c?(s.push(a),e.push(n)):t=t.concat(p)}),e.length){var c=this.getFullSpecItems(e);this.changeSpecItemsStatus(t,c),s.length>1&&e.forEach(function(s){var t=e.filter(function(e){return e!==s}),c=i.getFullSpecItems(t),a=r.exec(s)[1],n=i.specRows[a];i.changeSpecItemsStatus(n,c)})}else this.resetSpecItemsStatus()},getSettingId:function(){var s=this.specKeys.join(""),e=this.spec.spec_id.indexOf(s);if(e>-1)return this.spec.setting_id[e]},handleSpecChange:function(s,e,t){var i=t+"_"+s;this.specMaps[i].disabled||(s===this.specKeys[t]&&(s=-1),this.$set(this.specKeys,t,s),this.detectionSpecStatus())},specButtonDisabled:function(){return"-1"===this.settingId||0===Number(this.spec.data[this.settingId].spec_stock)}},props:{visible:{type:Boolean,required:!0,default:!1},productId:{type:String,required:!0},price:{type:String,required:!0}}}},282:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t(199),c=t.n(i),a=t(314),n=t(2),p=n(c.a,a.a,null,null,null);e.default=p.exports},314:function(s,e,t){"use strict";var i=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"good-spec"},[t("jfk-popup",{staticClass:"jfk-popup__specTicket",attrs:{position:"bottom",showCloseButton:!0,closeOnClickModal:!1,lockScroll:!0},model:{value:s.specVisible,callback:function(e){s.specVisible=e},expression:"specVisible"}},[t("div",{staticClass:"popup-box"},[s.spec.spec_type?t("div",{staticClass:"popup-spec"},[t("div",{staticClass:"section-title font-size--24 font-color-extra-light-gray"},[s._v("选择规格")]),s._v(" "),t("ul",{staticClass:"list"},s._l(s.spec.spec_type,function(e,i){return t("li",{key:s.spec.spec_type_id[i],staticClass:"item"},[t("div",{staticClass:"title font-size--24 font-color-light-gray"},[s._v(s._s(e))]),s._v(" "),t("div",{staticClass:"cont"},s._l(s.spec.spec_name_id[i],function(e,c){return t("span",{key:e,staticClass:"spec-item jfk-d-ib color-golden font-size--30 jfk-radio jfk-radio--shape-rect",class:{"jfk-radio--checked":e===s.specKeys[i],"jfk-radio--disabled":s.specMaps[i+"_"+e].disabled},on:{click:function(t){s.handleSpecChange(e,c,i)}}},[t("label",{staticClass:"jfk-radio__label"},[t("span",{staticClass:"jfk-radio__text"},[s._v(s._s(s.spec.spec_name[i][c]))]),s._v(" "),t("span",{staticClass:"jfk-radio__icon"},[t("i",{staticClass:"jfk-font icon-radio_icon_selected_default icon"})])])])}))])}))]):s._e(),s._v(" "),t("div",{staticClass:"popup-time"})])]),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:s.specVisible,expression:"specVisible"}],staticClass:"good-spec__footer"},[t("div",{staticClass:"jfk-clearfix"},[t("div",{staticClass:"jfk-fl-l price color-golden jfk-flex is-align-middle"},[t("div",{staticClass:"cont "},[t("span",{staticClass:"jfk-price__currency font-size--24"},[s._v("￥")]),s._v(" "),t("span",{staticClass:"jfk-price__number font-size--48"},[s._v(s._s(s.pricePackage))])])]),s._v(" "),t("div",{staticClass:"jfk-fl-r control"},[t("button",{staticClass:"jfk-button jfk-button--free jfk-button--higher jfk-button--primary font-size--34",attrs:{disabled:s.specButtonDisabled()}},[s._v("立即购买")])])])])],1)},c=[],a={render:i,staticRenderFns:c};e.a=a}});